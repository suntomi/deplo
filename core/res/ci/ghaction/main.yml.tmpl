# generated by deplo CLI https://github.com/suntomi/deplo don't edit by hand.
name: Deplo CI/CD

on: 
{entrypoint:>2}
  repository_dispatch:
    types: [{remote_job_dispatch_type}]

env:
  DEPLO_CI_PULL_REQUEST_URL: ${{{{ github.event.pull_request.url }}}}
  DEPLO_CI_EVENT_TYPE: ${{{{ github.event.action }}}}
  DEPLO_CI_EVENT_PAYLOAD: ${{{{ toJSON(github.event.client_payload) }}}}
{secrets:>2}
jobs:
  deplo-main:
    name: Start CI
    runs-on: ubuntu-latest
    outputs:
      DEPLO_OUTPUT_CLI_VERSION: ${{{{ steps.deplo-ci-kick.outputs.DEPLO_OUTPUT_CLI_VERSION }}}}
{outputs:>6}
    steps:
{fetchcli:>6}
{checkout:>6}
      - name: Start deplo
        id: deplo-ci-kick
        run: deplo ci kick
      - name: Setup ssh session to debug
        if: ${{{{ failure() }}}}
        uses: umegaya/action-tmate@a3d459813f3429bd95fc48bcd980b2fb40f10ad0
        with:
          sudo: true
  deplo-finish:
    name: Cleanup CI
    if: ${{{{ !failure() && ({need_cleanups}) }}}}
    needs: [{needs}]
    runs-on: ubuntu-latest
    steps:
{fetchcli:>6}
{checkout:>6}
      - name: Cleanup deplo
        id: deplo-ci-fin
        run: deplo ci fin
{debugger:>6}
{jobs:>2}