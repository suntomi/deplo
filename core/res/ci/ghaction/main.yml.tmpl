# generated by deplo CLI https://github.com/suntomi/deplo don't edit by hand.
name: Deplo CI/CD

on: 
{entrypoint:>2}
  repository_dispatch:
    types: [{remote_job_dispatch_type}]

env:
  DEPLO_GHACTION_CI_ID: ${{{{ github.run_id }}}}-${{{{ github.run_attempt }}}}
  DEPLO_GHACTION_PR_URL: ${{{{ github.event.pull_request.url }}}}
  DEPLO_GHACTION_EVENT_DATA: ${{ toJson(github) }}
  DEPLO_OVERWRITE_COMMIT: ${{{{ github.event.client_payload.commit }}}}
  DEPLO_OVERWRITE_RELEASE_TARGET: ${{{{ github.event.client_payload.release_target }}}}
  DEPLO_OVERWRITE_VERBOSITY: ${{{{ github.event.client_payload.verbosity }}}}
  DEPLO_OVERWRITE_WORKFLOW: ${{{{ github.event.client_payload.workflow }}}}
{secrets:>2}
jobs:
  deplo-boot:
    name: Start CI ${{{{ github.event.client_payload.job_id }}}}
    runs-on: ubuntu-latest
    outputs:
{outputs:>6}
    steps:
{fetchcli:>6}
{kick_checkout:>6}
      - name: Boot deplo
        id: deplo-boot
        run: deplo boot
      - name: Setup ssh session to debug
        if: ${{{{ failure() }}}}
        uses: umegaya/action-tmate@a3d459813f3429bd95fc48bcd980b2fb40f10ad0
        with:
          sudo: true
  deplo-halt:
    name: Cleanup CI
    if: ${{{{ !failure() && ({need_cleanups}) }}}}
    needs: [{needs}]
    runs-on: ubuntu-latest
{cleanup_envs:>4}
    steps:
{fetchcli:>6}
{fin_checkout:>6}
      - name: Halt deplo
        id: deplo-halt
        run: deplo halt
{debugger:>6}
{jobs:>2}